
#alignment

#!/bin/sh
#$-S /bin/sh
#$ -N novo_complement
#$ -o /scratch/project/grouppowell/Complement/novoalign_stats/
#$ -e /scratch/project/grouppowell/Complement/novoalign_stats/
#$ -q bignode.q,long.q
#$ -l h_vmem=20G

/share/apps/novocraft_2.07.13/bin/novoalign \
-d /scratch/data/reference_genomes/human/human_g1k_v37 -F STDFQ -f \
/scratch/project/grouppowell/Complement/fastq_run220312/KPOA0007_R1_001.fastq \
/scratch/project/grouppowell/Complement/fastq_run220312/KPOA0007_R2_001.fastq \
-a ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
-a CTCGGCATTCCTGCTGAACCGCTCTTCCGATCT \
-a AATGATACGGCGACCACCGAGATCTACACTCTTTCCCTACACGACGCTCTTCCGATCT \
-a CAAGCAGAAGACGGCATACGAGATCGGTCTCGGCATTCCTGCTGAACCGCTCTTCCGATCT \
-a ACACTCTTTCCCTACACGACGCTCTTCCGATCT \
-a CGGTCTCGGCATTCCTACTGAACCGCTCTTCCGATCT \
-a CAAGCAGAAGACGGCATACGAGATATCACGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCGATGTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTTAGGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTGACCAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACAGTGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCCAATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCAGATCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACTTGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGATCAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTAGCTTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGGCTACGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCTTGTAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAACATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCAAAAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGAAACCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTAATCGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAAGCAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCAACTAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGAATAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTACAGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAATGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCACCGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGACGGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGGCCGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAACAAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCACGATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGATATAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTATAATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAACCCCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCACTCAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGATGCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTCATTCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAACTTGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCAGGCGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCAAGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATAATTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAGACTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCATGGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCACTTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTCCCGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAGCGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCATTTTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCCGCGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTCGAAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAAGGACGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCAACAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCCTTAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATACGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAATAGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCACGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGCTCCAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTCGGCAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACAAACGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCCATGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGGCACAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTCTACCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACATCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCCCCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGGCCTGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATCCTAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACCCAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCGCAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGTAGAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTGAATGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACCGGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCTTAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGTCCGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTGCCATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACGATAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCGAGAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGTGAAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATCTATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACTCTCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCGGAATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGTGGCCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTGCTGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATACTGATGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCTAGCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGTTTCGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTGGCGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGAAGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCTATACGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCGTACGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATGAGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGATAGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCTCAGAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGAGTGGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTTCGAAGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGCATCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCTGCTGGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATGGTAGCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATTTCTCCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGCGCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATCCGTCCGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATATTCCTGTGACTGGAGTTC \
-a CAAGCAGAAGACGGCATACGAGATAGGTTTGTGACTGGAGTTC \
-g 40 -x 15 -q 2 \
-r Random \
-i PE 175,50 \
-c 1 \
-p 7,10 0.3,10 \
-k \
-K /scratch/project/grouppowell/complement/novoalign_stats/KPOA0007.test -o SAM \
$'@RG\tID:Complement\tPL:Illumina\tPU:hiseq\tSM:KPOA0007' \
> /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.stats \
> /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sam

####################################################################################
#convert to bam

/share/bin/samtools view -bS /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sam \
> /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.bam

/bin/rm /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sam

#####################################################################################
#sort and index

/share/bin/samtools sort /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.bam \
/scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sorted

/bin/rm /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.bam

/share/bin/samtools index /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sorted.bam

######################################################################################
#remove duplicate reads

/usr/java/latest/bin/java -Xmx6g -jar /share/apps/picard-tools_1.35/jar/MarkDuplicates.jar \
INPUT=/scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sorted.bam \
OUTPUT=/scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam \
METRICS_FILE=/scratch/project/grouppowell/Complement/MarkDuplicates_metrics/KPOA0007.markdups_metric.file \
REMOVE_DUPLICATES=true \
TMP_DIR=/home/mluptonbrc/jump2grouppowell/Complement/temp \
ASSUME_SORTED=true VALIDATION_STRINGENCY=SILENT

/share/bin/samtools index /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam

/bin/rm /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sorted.bam
/bin/rm /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.sorted.bam.bai

###########################################################################################
#make metric files

/usr/java/latest/bin/java -Xmx4g -jar /share/apps/picard-tools_1.35/jar/CalculateHsMetrics.jar \
INPUT=/scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam \
OUTPUT=/scratch/project/grouppowell/Complement/HsMetrics/KPOA0007.HybridSelectionMetrics \
BAIT_INTERVALS=/home/mluptonbrc/jump2grouppowell/Complement/HsMetrics/baitgroupfile_PICARD.txt \
TARGET_INTERVALS=/home/mluptonbrc/jump2grouppowell/Complement/HsMetrics/targetIntervalfile_PICARD.txt \
TMP_DIR=/home/mluptonbrc/jump2grouppowell/Complement/temp \
VALIDATION_STRINGENCY=SILENT 

/usr/java/latest/bin/java -Xmx6g -jar /share/apps/picard-tools_1.35/jar/CollectAlignmentSummaryMetrics.jar \
INPUT=/scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam \
OUTPUT=/scratch/project/grouppowell/Complement/AlignmentSummaryMetrics/KPOA0007.AlignmentSummaryMetrics \
TMP_DIR=/home/mluptonbrc/jump2grouppowell/Complement/temp \
VALIDATION_STRINGENCY=SILENT \
IS_BISULFITE_SEQUENCED=false MAX_INSERT_SIZE=100000 \
REFERENCE_SEQUENCE=/scratch/data/reference_genomes/human/human_g1k_v37.fasta \
ADAPTER_SEQUENCE=null

################################################################################################################
Make a bed file with indel positions

/usr/java/latest/bin/java -Xmx10g -jar /share/apps/GenomeAnalysisTK_1.0.4905/GenomeAnalysisTK.jar -T IndelGenotyperV2 \
-R /scratch/data/reference_genomes/human/human_g1k_v37.fasta \
--DBSNP /scratch/data/reference_genomes/human/dbsnp_131_b37.final.rod \
-U \
-I /scratch/project/grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam \
-bed /scratch/project/grouppowell/Complement/IndelGenotyper/KPOA0007.indels.raw.bed \
-o /scratch/project/grouppowell/Complement/IndelGenotyper/KPOA0007.indels.vcf \
-minCoverage 8 --window_size 10000 --minFraction 0.3 -minConsensusFraction 0.7 \
-S SILENT


################################################################################################################################

#snp calling (put all bam files in at once)

#!/bin/sh
#$ -S /bin/sh
#$ -M michelle.lupton@kcl.ac.uk
#$ -m beas
#$ -N UnifiedGenotyper
#$ -q long.q,bignode.q
#$ -l h_vmem=20G

/usr/java/latest/bin/java -Xmx10g -jar /share/apps/GenomeAnalysisTK_1.0.4905/GenomeAnalysisTK.jar -T UnifiedGenotyper \
-R /scratch/data/reference_genomes/human/human_g1k_v37.fasta \
-D /scratch/data/reference_genomes/human/dbsnp_131_b37.final.rod \
-L /home/mluptonbrc/jump2grouppowell/Complement/DepthOfCoverage/baitgroupfile.picard \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0113.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0043.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0022.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0025.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0033.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0048.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0041.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0051.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0014.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0039.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0010.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0038.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0008.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0051.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0032.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0049.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0048.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0006.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0006.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0004.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0005.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0033.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0021.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0018.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0018.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0047.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0001.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0052.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0002.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0038.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0039.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0024.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0028.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSM0017.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0021.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0016.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZM0006.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0138.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0172.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0038.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0009.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0033.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0049.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0150.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSA0035.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0084.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0052.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0047.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0049.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0050.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0017.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0158.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0002.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0160.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0007.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0144.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0024.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGC0036.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0018.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0135.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0012.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0020.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/THSC0011.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0155.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0051.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0040.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0129.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0050.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0149.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0041.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0068.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0049.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0037.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0087.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGA0003.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0009.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0093.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0074.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0043.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0013.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/PRGM0044.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0060.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0044.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0044.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0067.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0106.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0056.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0035.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0071.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0069.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0145.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0045.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0059.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0073.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0021.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0014.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0041.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0078.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0031.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0075.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0036.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZM0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0082.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0107.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0011.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0049.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0029.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0065.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0001.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0047.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0044.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0029.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0039.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0037.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0015.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0032.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0011.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0027.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0003.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0031.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0039.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZM0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0008.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0007.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0050.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0045.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0025.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0046.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0042.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0041.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0020.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LND0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0043.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0029.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0019.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0034.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0012.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0026.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0033.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0036.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0047.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0018.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0007.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0004.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOC0040.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZM0007.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0040.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0025.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZC0023.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0022.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0003.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0037.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0044.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOA0041.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/KPOM0050.duplicatesremoved.bam \
-I /home/mluptonbrc/jump2grouppowell/Complement/novoalign_alignments/LDZA0036.duplicatesremoved.bam \
-o /home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.raw.vcf \
-stand_call_conf 50.0 \
-stand_emit_conf 10.0 \
-G Standard \
-metrics /home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.metrics

###################################################################################################################
################
make indel mask
#!/bin/sh
#$ -S /bin/sh
#$ -M michelle.lupton@kcl.ac.uk
#$ -m beas
#$ -N indelGeno
#$ -q bignode.q,long.q,short.q
#$ -l h_vmem=20G


/bin/cat /scratch/project/grouppowell/Complement/IndelGenotyper/240412/*.indels.raw.bed > \
/scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.indels.raw.bed

/share/bin/mergeBed -nms -i /scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.indels.raw.bed | \
/share/bin/sortBed -i stdin > /scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.putative.indels.sorted.marged.bed

/usr/bin/python /home/mluptonbrc/bin/makeIndelMask.py \
/scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.putative.indels.sorted.marged.bed \
5 /scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.putative.indels.mask.5.bed

##problem where indel mask sorted incorrectly-have to correct order in excel, & deleted GLs
###################################################################################################################
##variant filteration

#!/bin/sh
#$ -S /bin/sh
#$ -M michelle.lupton@kcl.ac.uk
#$ -m beas
#$ -N indelGeno
#$ -q bignode.q,long.q,short.q
#$ -l h_vmem=20G


/usr/java/latest/bin/java -Xmx8g -jar /share/apps/GenomeAnalysisTK_1.0.4905/GenomeAnalysisTK.jar -T VariantFiltration \
-R /scratch/data/reference_genomes/human/human_g1k_v37.fasta \
-D /scratch/data/reference_genomes/human/dbsnp_131_b37.final.rod \
-o /home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.VariantFiltration.vcf \
-B:variant,VCF /home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.raw.vcf \
-B:mask,Bed /scratch/project/grouppowell/Complement/IndelGenotyper/240412/all.putative.indels.mask.5.bed --maskName InDel \
--clusterSize 3 --clusterWindowSize 10 \
--filterExpression "DP <= 4" --filterName "DP4" \
--filterExpression "DP < 8 && DP > 4" --filterName "DP8" \
--filterExpression "QUAL < 20" --filterName "QUAL20" \
--filterExpression "SB > -0.10" --filterName "StrandBias" \
--filterExpression "HRun > 5.0" --filterName "HRun5" \
--filterExpression "HRun > 10" --filterName "HRun10" \
--filterExpression "QD < 5.0" --filterName "QD5" \
--filterExpression "MQ0 >= 4 && ((MQ0 / (1.0 * DP)) > 0.1)" --filterName "hard2validate" \
--genotypeFilterExpression "DP <= 4" --genotypeFilterName "DP4" \
--genotypeFilterExpression "DP < 8 && DP > 4" --genotypeFilterName "DP8"

##########################################################################################################################
##annotation

/share/apps/annovar_20110117/bin/convert2annovar.pl -format vcf4 \
/home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.raw.vcf \
-outfile /home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.VariantFiltration.annovar.out

/share/apps/annovar_20110117/bin/annotate_variation.pl \
/home/mluptonbrc/jump2grouppowell/Complement/UnifiedGenotyper/snps.run96_2.VariantFiltration.annovar.out \
/share/apps/annovar_20110117/humandb -buildver hg19



